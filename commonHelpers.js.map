{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '44079698-e6186d09374e2a24bdfa7da89';\n\nexport async function searchImage(currentQuery, page = 1) {\n  const { data } = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      page: page,\n      per_page: 15,\n      q: currentQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n    },\n  });\n  return data;\n}\n","export function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item\">\n\t<a class=\"gallery-link\" href=\"${largeImageURL}\">\n\t\t<img\n            class=\"gallery-img\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n        />\n        <ul class=\"gallery-info\">\n         <li class=\"galery-info-item\">\n             <h2 class=\"gallery-info-title\">Likes</h2>\n             <p class=\"gallery-info-text\">${likes}</p>\n        </li>\n        <li class=\"gallery-info-item\">\n            <h2 class=\"gallery-info-title\">Views</h2>\n            <p class=\"gallery-info-text\">${views}</p>\n        </li>\n         <li class=\"gallery-info-item\">\n            <h2 class=\"gallery-info-title\">Comments</h2>\n            <p class=\"gallery-info-text\">${comments}</p>\n        </li>\n        <li class=\"gallery-info-item\">\n            <h2 class=\"gallery-info-title\">Downloads</h2>\n            <p class=\"gallery-info-text\">${downloads}</p>\n        </li>\n     </ul>\n\t</a>\n</li>`\n    )\n    .join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { searchImage } from './js/pixabay-api.js';\nimport { createMarkup } from './js/render-functions';\n\nconst formElem = document.querySelector('.form');\nconst imageList = document.querySelector('.gallery');\nconst searchLoader = document.getElementById('search-loader');\nconst loadMoreLoader = document.getElementById('load-more-loader');\nconst loadMore = document.querySelector('.js-load-more');\n\nfunction showLoader(loader) {\n  loader.classList.add('is-open');\n}\n\nfunction hideLoader(loader) {\n  loader.classList.remove('is-open');\n}\n\nlet currentQuery = '';\nlet currentPage = 1;\n\nformElem.addEventListener('submit', handleSubmit);\nloadMore.addEventListener('click', onLoadMore);\n\nfunction handleSubmit(event) {\n  event.preventDefault();\n  currentQuery = event.target.elements['search-input'].value\n    .trim()\n    .toLowerCase();\n\n  if (!currentQuery) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  currentPage = 1;\n  formElem.reset();\n  imageList.innerHTML = '';\n  loadMore.classList.add('js-more-hidden');\n  fetchImages('search');\n}\n\nfunction onLoadMore() {\n  currentPage += 1;\n  loadMore.classList.add('js-more-hidden');\n  fetchImages('loadMore');\n}\n\nfunction fetchImages(type) {\n  if (type === 'search') {\n    showLoader(searchLoader);\n  } else if (type === 'loadMore') {\n    showLoader(loadMoreLoader);\n  }\n\n  searchImage(currentQuery, currentPage)\n    .then(data => {\n      hideLoader(searchLoader);\n      hideLoader(loadMoreLoader);\n\n      if (!data.hits.length) {\n        if (currentPage === 1) {\n          iziToast.error({\n            title: 'Error',\n            message:\n              'Sorry, there are no images matching your search query. Please try again!',\n            position: 'topRight',\n          });\n        }\n        loadMore.classList.add('js-more-hidden');\n      } else {\n        const markup = createMarkup(data.hits);\n        imageList.insertAdjacentHTML('beforeend', markup);\n        const lightbox = new SimpleLightbox('.gallery-item a', {\n          captionsData: 'alt',\n          captionDelay: 250,\n        });\n        lightbox.refresh();\n\n        if (currentPage > 1) {\n          const galleryItems = document.querySelectorAll('.gallery-item');\n          if (galleryItems.length > 0) {\n            const { height: cardHeight } =\n              galleryItems[0].getBoundingClientRect();\n            window.scrollBy({\n              top: cardHeight * 2,\n              behavior: 'smooth',\n            });\n          }\n        }\n\n        if (data.totalHits > imageList.children.length) {\n          loadMore.classList.remove('js-more-hidden');\n        } else {\n          loadMore.classList.add('js-more-hidden');\n          iziToast.info({\n            title: 'Info',\n            message:\n              \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n          });\n        }\n      }\n    })\n    .catch(error => {\n      hideLoader(searchLoader);\n      hideLoader(loadMoreLoader);\n      loadMore.classList.add('js-more-hidden');\n      iziToast.error({\n        title: 'Error',\n        message: `An error occurred: ${error.message}`,\n        position: 'topRight',\n      });\n    });\n}\n"],"names":["BASE_URL","API_KEY","searchImage","currentQuery","page","data","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","formElem","imageList","searchLoader","loadMoreLoader","loadMore","showLoader","loader","hideLoader","currentPage","handleSubmit","onLoadMore","event","iziToast","fetchImages","type","markup","SimpleLightbox","galleryItems","cardHeight","error"],"mappings":"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"}